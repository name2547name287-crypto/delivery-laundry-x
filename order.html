<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>à¸ªà¸–à¸²à¸™à¸°à¸­à¸­à¹€à¸”à¸­à¸£à¹Œ</title>
<link rel="stylesheet" href="css/order.css">
</head>
<body>

  <div class="order-topbar">
  <button class="back-home" onclick="location.href='index.html'">
    â¬…ï¸ à¸à¸¥à¸±à¸šà¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸
  </button>
</div>

<h2>ğŸ“¦ à¸ªà¸–à¸²à¸™à¸°à¸­à¸­à¹€à¸”à¸­à¸£à¹Œà¸‚à¸­à¸‡à¸‰à¸±à¸™</h2>
<div id="orderList"></div>
 


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script src="js/firebase.js"></script>
<script src="js/auth.js"></script>

<script>
function statusText(status) {
  if (status === "wait") return "ğŸ•’ à¸£à¸­à¸£à¸±à¸šà¸œà¹‰à¸²";
  if (status === "pickup") return "ğŸšš à¸£à¸±à¸šà¸œà¹‰à¸²à¹à¸¥à¹‰à¸§";
  if (status === "washing") return "ğŸ§¼ à¸à¸³à¸¥à¸±à¸‡à¸‹à¸±à¸";
  if (status === "delivering") return "ğŸ“¦ à¸à¸³à¸¥à¸±à¸‡à¸ªà¹ˆà¸‡";
  if (status === "done") return "âœ… à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™";
  return "-";
}

function payText(status) {
  if (status === "unpaid") return "âŒ à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸Šà¸³à¸£à¸°";
  if (status === "paid") return "â³ à¸£à¸­à¹à¸­à¸”à¸¡à¸´à¸™à¸¢à¸·à¸™à¸¢à¸±à¸™";
  if (status === "confirmed") return "âœ… à¸Šà¸³à¸£à¸°à¹à¸¥à¹‰à¸§";
  return "-";
}

auth.onAuthStateChanged(async user => {
  if (!user) {
    location.href = "login.html";
    return;
  }

  const snap = await db.collection("orders")
    .where("userId", "==", user.uid)
    .orderBy("createdAt", "desc")
    .get();

  const box = document.getElementById("orderList");
  box.innerHTML = "";

  if (snap.empty) {
    box.innerHTML = "âŒ à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸­à¸­à¹€à¸”à¸­à¸£à¹Œ";
    return;
  }

  snap.forEach(doc => {
    const o = doc.data();

    box.innerHTML += `
      <div class="order-card">
        <div class="order-row">ğŸ§º ${o.weight} kg</div>
        <div class="order-row order-price">ğŸ’° ${o.price} à¸šà¸²à¸—</div>
        <div class="order-row">â° ${o.bookingDate} ${o.timeSlot}</div>
        <div class="order-status">${statusText(o.status)}</div>
        <div class="order-pay">ğŸ’³ ${payText(o.paymentStatus)}</div>
      </div>
    `;
  });
});
</script>


</body>
</html>
