<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</title>
<link rel="stylesheet" href="css/order.css">
</head>
<body>

<h2>üì¶ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h2>
<div id="orderList"></div>
 


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script src="js/firebase.js"></script>
<script src="js/auth.js"></script>

<script>
function statusText(status) {
  if (status === "wait") return "üïí ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏ú‡πâ‡∏≤";
  if (status === "pickup") return "üöö ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏õ‡∏£‡∏±‡∏ö";
  if (status === "washing") return "üßº ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏±‡∏Å";
  if (status === "delivering") return "üì¶ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á";
  if (status === "done") return "‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô";
  return status || "-";
}

auth.onAuthStateChanged(async user => {
  if (!user) {
    location.href = "login.html";
    return;
  }

  const snap = await db.collection("orders")
    .where("userId", "==", user.uid)
    .orderBy("createdAt", "desc")
    .get();

  const box = document.getElementById("orderList");
  box.innerHTML = "";

  if (snap.empty) {
    box.innerHTML = "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á";
    return;
  }

  snap.forEach(doc => {
    const o = doc.data();
    box.innerHTML += `
  <div class="order-card">
    <div class="order-top">
      <span>üß∫ ${o.weight} kg</span>
      <span class="price">üí∞ ${o.price} ‡∏ö‡∏≤‡∏ó</span>
    </div>

    <div class="order-mid">
      ‚è∞ ${o.bookingDate} ${o.timeSlot}
    </div>

    <div style="font-size:12px;opacity:.6;margin-bottom:6px">
  ORDER
</div>

    <div class="order-status status-${o.status}">
  ${statusText(o.status)}
</div>
 

  </div>
`;
  });
});

</script>

</body>
</html>
